# API YaMDB

![Python]
![DjangoREST]
![Postgres]
![Nginx]
___
Проект **API YaMDb** собирает **отзывы** (**Review**) пользователей **на 
произведения** (**Titles**). Произведения делятся на категории: «Книги», 
«Фильмы», «Музыка». Список **категорий** (**Category**) может быть расширен 
администратором (например, можно добавить категорию «изобразительное 
искусство» или «Ювелирка»).

Сами произведения в **API YaMDb** не хранятся, здесь нельзя посмотреть фильм 
или послушать музыку.

В каждой категории есть **произведения**: книги, фильмы или музыка. Например, 
в категории «Книги» могут быть произведения «Винни-Пух и все-все-все» и 
«Марсианские хроники», а в категории «Музыка» — песня «Давеча» группы 
«Насекомые» и вторая сюита Баха.

Произведению может быть присвоен **жанр** (**Genre**) из списка 
предустановленных (например, «Сказка», «Рок» или «Артхаус»). Новые жанры 
может создавать только администратор.

Благодарные или возмущённые пользователи оставляют к произведениям текстовые 
**отзывы** (**Review**) и ставят произведению оценку в диапазоне от одного до 
десяти (целое число); из пользовательских оценок формируется усреднённая 
оценка произведения — **рейтинг** (целое число). На одно произведение 
пользователь может оставить только один отзыв.


## Как запустить проект в docker:

1) Установить docker и docker-compose https://docs.docker.com/get-docker/

2) скачать на локальную машину папку infra c конфигурационными файлами nginx и env scp -r

3) Запустить из установленной папки docker-compose.yaml командой 
docker compose up docker-compose.yaml

4) После того, как запустится docker необходимо выполнить миграции базы командой 
docker-compose exec web python manage.py migrate

5) Создать суперпользователя командой
docker-compose exec web python manage.py createsuperuser

6) Собрать статические файлы для nginx командой 
docker-compose exec web python manage.py collectstatic --no-input

7) Для загрузки тестовых данных из csv-файлов выполнить команды:
docker exec -it <CONTAINER ID> bash
python3 manage.py loadcsv


## Самостоятельная регистрация пользователей
1. Пользователь отправляет POST-запрос на добавление нового пользователя с 
параметрами `email` и `username` на эндпоинт `/api/v1/auth/signup/`: 
```json
{
    "username": "user",
    "email": "user@mail.ru"
}
```
2. Пользователю приходит письмо с кодом подтверждения `confirmation_code` на 
адрес `email`;
3. Пользователь отправляет POST-запрос с параметрами `username` и 
`confirmation_code` на эндпоинт `/api/v1/auth/token/`, в ответе на запрос ему 
приходит `token` (JWT-токен):
```json
{
    "username": "user",
    "confirmation_code": "ae6c10d0-0b13-554c-b976-a05d8a18f0cc"
}
```
4. При желании пользователь отправляет PATCH-запрос на эндпоинт 
`/api/v1/users/me/` и заполняет поля в своём профайле.



## Создание пользователя администратором
Пользователя может создать администратор — через админ-зону сайта или через 
POST-запрос на специальный эндпоинт `/api/v1/users/` В этот момент письмо с 
кодом подтверждения пользователю не отправляется.

После этого пользователь должен самостоятельно отправить свой `email` и 
`username` на эндпоинт `/api/v1/auth/signup/`, в ответ ему должно прийти 
письмо с кодом подтверждения.

Далее пользователь отправляет POST-запрос с параметрами `username` и 
`confirmation_code` на эндпоинт `/api/v1/auth/token/`, в ответе на запрос ему 
приходит `token` (JWT-токен), как и при самостоятельной регистрации.


## Ресурсы API YaMDb
- **auth**: аутентификация.
- **users**: пользователи.
- **titles**: произведения, к которым пишут отзывы (определённый фильм, 
  книга или песенка).
- **categories**: категории (типы) произведений («Фильмы», «Книги», 
  «Музыка»).
- **genres**: жанры произведений. Одно произведение может быть привязано 
  к нескольким жанрам.
- **reviews**: отзывы на произведения. Отзыв привязан к определённому 
  произведению.
- **comments**: комментарии к отзывам. Комментарий привязан к 
  определённому отзыву.


## Документация
После запуска проекта - по адресу: `http://127.0.0.1:8000/redoc/` доступна 
документация.


## Над проектом работали:
- [Андрей Распутин](https://github.com/rasputin-pro)
- [Кирилл Сухарев](https://github.com/Soliton80)
- [Александр Корнеев](https://github.com/rtx4090)
